import{r as d,O as C,Y as c,A as n,Q as r}from"./index-D5CrZEbk.js";const _=()=>{const[h,u]=d.useState({upload:!1,value:0}),[f,y]=d.useState({categories:[]}),[g,A]=d.useState({Products:[]}),[I,$]=d.useState([]),[v,p]=d.useState([]),[b,m]=d.useState(0),[w,P]=d.useState({name:"",description:"",category:"",subcategory:[],brand:"",measurement:"",color:"",images:[]}),B=C();return{CreateProductAPI:async({product:t,token:s})=>{u({upload:!0,value:0});try{if(!t.images.length>0){r.error("Please add at least one image");return}else if(!t.category){r.error("Please select a category");return}if(!t.name&&s)return;const e=new FormData;e.append("name",t?.name),e.append("description",t?.description),e.append("brand",t?.brand),e.append("category",t?.category),e.append("subCategory",JSON.stringify(t?.subCategory?.map(a=>a?.value))),e.append("measurement",t?.measurement),e.append("color",t?.color),t?.images.forEach(a=>{e.append("images",a)}),await c.post(`${n}/v1/product/admin/create-product`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${s}`},onUploadProgress:a=>{const o=Math.round(a.loaded*100/a.total);u({upload:!0,value:o})}}).then(a=>{a?.data?.success&&r.success(a?.data?.message)}).catch(a=>{console.log(a),a.response?r.error(a?.response?.data?.message):r.error(a?.message)})}catch(e){console.log(e)}u({upload:!1,value:0})},Progress:h,Attributes:f,GetProductAttributesAPI:async({token:t})=>{try{if(!t)return;await c.get(`${n}/v1/product/admin/get-product-attributes`,{headers:{Authorization:`Bearer ${t}`}}).then(s=>{s?.data?.success&&y({categories:s?.data?.result})}).catch(s=>{s.response?r.error(s?.response?.data?.message):r.error(s?.message)})}catch(s){console.error(s)}},GetProductListAPI:async({token:t,page:s,limit:e})=>{try{if(!t)return;await c.get(`${n}/v1/product/admin/list`,{headers:{Authorization:`Bearer ${t}`},params:{page:s||1,limit:e||10}}).then(a=>{a?.data?.success&&A({...g,Products:a?.data?.result?.products})}).catch(a=>{a.response?r.error(a?.response?.data?.message):r.error(a?.message)})}catch(a){console.error(a)}},ProductList:g,GetProductByIdAPI:async({pid:t})=>{try{if(!t)return;await c.get(`${n}/v1/product/${t}`).then(s=>{s?.data?.success&&$(s?.data?.result)}).catch(s=>{s.response?r.error(s?.response?.data?.message):r.error(s?.message)})}catch(s){console.error(s)}},Product:I,GetProductsAPI:async({page:t,limit:s})=>{try{await c.get(`${n}/v1/product`,{params:{page:t||1,limit:s||10}}).then(e=>{e?.data?.success&&e.data?.result?.length>0&&(p(a=>[...a,...e.data.result]),m(e?.data?.total))}).catch(e=>{e.response?r.error(e?.response?.data?.message):r.error(e?.message)})}catch(e){console.error(e)}},Products:v,GetProductsByCategoryAPI:async({page:t,limit:s,category:e})=>{try{if(!e)return;await c.get(`${n}/public/category/${e}`,{params:{page:t||1,limit:s||10}}).then(a=>{a?.data?.success&&a.data?.result?.length>0&&(m(a?.data?.total),p(o=>{const l=new Map(o.map(i=>[i._id,i]));return a.data.result.forEach(i=>{l.has(i._id)||l.set(i._id,i)}),Array.from(l.values())}))}).catch(a=>{a.response?r.error(a?.response?.data?.message):r.error(a?.message)})}catch(a){console.error(a)}},Total:b,setProducts:p,setTotal:m,DeleteProductAPI:async({id:t,token:s})=>{try{if(!t||!s)return;await c.delete(`${n}/v1/product/admin/delete/${t}`,{headers:{Authorization:`Bearer ${s}`}}).then(e=>{e?.data?.success&&r.success(e?.data?.message)}).catch(e=>{e.response?r.error(e?.response?.data?.message):r.error(e?.message)})}catch(e){console.error(e)}},UpdateProductAPI:async({product:t,token:s,id:e})=>{u({upload:!0,value:0});try{if(!t?.name?.length>0){r.error("Name missing");return}else if(!e){r.error("Product Missing");return}if(!t.name||!s)return;const a=new FormData;a.append("name",t?.name),a.append("description",t?.description),a.append("brand",t?.brand),a.append("measurement",t?.measurement),a.append("color",t?.color),await c.put(`${n}/v1/product/admin/update-product/${e}`,a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${s}`},onUploadProgress:o=>{const l=Math.round(o.loaded*100/o.total);u({upload:!0,value:l})}}).then(o=>{o?.data?.success&&(r.success(o?.data?.message),B("/my-admin/product-list"))}).catch(o=>{o.response?r.error(o?.response?.data?.message):r.error(o?.message)})}catch(a){console.log(a)}u({upload:!1,value:0})},AdminProductByIdAPI:async({pid:t,token:s})=>{try{if(!t||!s)return;await c.get(`${n}/v1/product/admin/${t}`,{headers:{Authorization:`Bearer ${s}`}}).then(e=>{e?.data?.success&&P(e?.data?.result)}).catch(e=>{e.response?r.error(e?.response?.data?.message):r.error(e?.message)})}catch(e){console.error(e)}},ProductDetails:w,setProductDetails:P}};export{_ as u};
