import{r as d,O as C,Y as c,A as n,Q as r}from"./index-CZDcjD-5.js";const F=()=>{const[h,u]=d.useState({upload:!1,value:0}),[f,y]=d.useState({categories:[]}),[g,A]=d.useState({Products:[]}),[I,$]=d.useState([]),[v,p]=d.useState([]),[b,m]=d.useState(0),[w,P]=d.useState({name:"",description:"",category:"",subcategory:"",brand:"",measurement:"",color:"",images:[]}),B=C();return{CreateProductAPI:async({product:a,token:s})=>{u({upload:!0,value:0});try{if(!a.images.length>0){r.error("Please add at least one image");return}else if(!a.category){r.error("Please select a category");return}if(!a.name&&s)return;const e=new FormData;e.append("name",a?.name),e.append("description",a?.description),e.append("brand",a?.brand),e.append("category",a?.category),e.append("subCategory",a?.subCategory),e.append("measurement",a?.measurement),e.append("color",a?.color),a?.images.forEach(t=>{e.append("images",t)}),await c.post(`${n}/v1/product/admin/create-product`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${s}`},onUploadProgress:t=>{const o=Math.round(t.loaded*100/t.total);u({upload:!0,value:o})}}).then(t=>{t?.data?.success&&r.success(t?.data?.message)}).catch(t=>{console.log(t),t.response?r.error(t?.response?.data?.message):r.error(t?.message)})}catch(e){console.log(e)}u({upload:!1,value:0})},Progress:h,Attributes:f,GetProductAttributesAPI:async({token:a})=>{try{if(!a)return;await c.get(`${n}/v1/product/admin/get-product-attributes`,{headers:{Authorization:`Bearer ${a}`}}).then(s=>{s?.data?.success&&y({categories:s?.data?.result})}).catch(s=>{s.response?r.error(s?.response?.data?.message):r.error(s?.message)})}catch(s){console.error(s)}},GetProductListAPI:async({token:a,page:s,limit:e})=>{try{if(!a)return;await c.get(`${n}/v1/product/admin/list`,{headers:{Authorization:`Bearer ${a}`},params:{page:s||1,limit:e||10}}).then(t=>{t?.data?.success&&A({...g,Products:t?.data?.result?.products})}).catch(t=>{t.response?r.error(t?.response?.data?.message):r.error(t?.message)})}catch(t){console.error(t)}},ProductList:g,GetProductByIdAPI:async({pid:a})=>{try{if(!a)return;await c.get(`${n}/v1/product/${a}`).then(s=>{s?.data?.success&&$(s?.data?.result)}).catch(s=>{s.response?r.error(s?.response?.data?.message):r.error(s?.message)})}catch(s){console.error(s)}},Product:I,GetProductsAPI:async({page:a,limit:s})=>{try{await c.get(`${n}/v1/product`,{params:{page:a||1,limit:s||10}}).then(e=>{e?.data?.success&&e.data?.result?.length>0&&(p(t=>[...t,...e.data.result]),m(e?.data?.total))}).catch(e=>{e.response?r.error(e?.response?.data?.message):r.error(e?.message)})}catch(e){console.error(e)}},Products:v,GetProductsByCategoryAPI:async({page:a,limit:s,category:e})=>{try{if(!e)return;await c.get(`${n}/public/category/${e}`,{params:{page:a||1,limit:s||10}}).then(t=>{t?.data?.success&&t.data?.result?.length>0&&(m(t?.data?.total),p(o=>{const l=new Map(o.map(i=>[i._id,i]));return t.data.result.forEach(i=>{l.has(i._id)||l.set(i._id,i)}),Array.from(l.values())}))}).catch(t=>{t.response?r.error(t?.response?.data?.message):r.error(t?.message)})}catch(t){console.error(t)}},Total:b,setProducts:p,setTotal:m,DeleteProductAPI:async({id:a,token:s})=>{try{if(!a||!s)return;await c.delete(`${n}/v1/product/admin/delete/${a}`,{headers:{Authorization:`Bearer ${s}`}}).then(e=>{e?.data?.success&&r.success(e?.data?.message)}).catch(e=>{e.response?r.error(e?.response?.data?.message):r.error(e?.message)})}catch(e){console.error(e)}},UpdateProductAPI:async({product:a,token:s,id:e})=>{u({upload:!0,value:0});try{if(!a?.name?.length>0){r.error("Name missing");return}else if(!e){r.error("Product Missing");return}if(!a.name||!s)return;const t=new FormData;t.append("name",a?.name),t.append("description",a?.description),t.append("brand",a?.brand),t.append("measurement",a?.measurement),t.append("color",a?.color),await c.put(`${n}/v1/product/admin/update-product/${e}`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${s}`},onUploadProgress:o=>{const l=Math.round(o.loaded*100/o.total);u({upload:!0,value:l})}}).then(o=>{o?.data?.success&&(r.success(o?.data?.message),B("/my-admin/product-list"))}).catch(o=>{o.response?r.error(o?.response?.data?.message):r.error(o?.message)})}catch(t){console.log(t)}u({upload:!1,value:0})},AdminProductByIdAPI:async({pid:a,token:s})=>{try{if(!a||!s)return;await c.get(`${n}/v1/product/admin/${a}`,{headers:{Authorization:`Bearer ${s}`}}).then(e=>{e?.data?.success&&P(e?.data?.result)}).catch(e=>{e.response?r.error(e?.response?.data?.message):r.error(e?.message)})}catch(e){console.error(e)}},ProductDetails:w,setProductDetails:P}};export{F as u};
